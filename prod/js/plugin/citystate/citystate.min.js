!function(a){"use strict";var b={};b.init=function(){this.setData().start()},b.setData=function(){return $(this.options.selectState).length&&$(this.options.selectCity).length&&($(this.options.selectState).attr({"data-list":"states","data-list-group":this.options.group,"data-list-initials":this.options.initials,"data-list-start":this.options.initState,"data-list-filter":this.options.filterStates}),$(this.options.selectCity).attr({"data-list":"cities","data-list-group":this.options.group,"data-list-start":this.options.initCity})),this},b.start=function(){var a=this;localStorage.getItem("cfw_citst_states")||a.getJson("states",null,function(){a.dealSelects()}),localStorage.getItem("cfw_citst_states")&&a.dealSelects()},b.getJson=function(a,b,c){var d=this;if(!localStorage.getItem("cfw_citst_"+a)){var e="states"==a?"/json/states.min.json":"/json/cities/"+a.toLowerCase()+".min.json";$.getJSON(e,function(e){localStorage.setItem("cfw_citst_"+a,JSON.stringify(e)),b&&d.dealData(a,b,e),"function"==typeof c&&c()})}b&&localStorage.getItem("cfw_citst_"+a)&&d.dealData(a,b,JSON.parse(localStorage.getItem("cfw_citst_"+a)))},b.dealData=function(a,b,c){var d="states"==a?'<option value="0">Selecione um estado</option>':"";d+=this.generateOptions(a,b,c),this.putOptions(a,b,d)},b.dealSelects=function(){var a=this;$('select[data-list]:not([data-list-loaded="true"])').each(function(){var b=$(this).attr("data-list");if("states"==b)a.getJson(b,$(this));else if("cities"==b){var c=$(this),d=$('[data-list="states"][data-list-group="'+c.attr("data-list-group")+'"]');if(d.attr("data-list-start")||a.disableCities(c),d.attr("data-list-start"))var e=setInterval(function(){d.attr("data-list-loaded")&&(clearInterval(e),a.getJson(d.children("option:selected").attr("data-uf"),c))})}}),$('[data-list="states"]').on("change",function(b){b.stopImmediatePropagation();var c=$('[data-list="cities"][data-list-group="'+$(this).attr("data-list-group")+'"]');c.length&&(0!=$(this).val()&&a.getJson($(this).children("option:selected").attr("data-uf"),c),0==$(this).val()&&a.disableCities(c))})},b.putOptions=function(a,b,c){b.attr({disabled:!1,"data-list-loaded":!0}).html(c);var d="states"==a?a:"cities";$(document).trigger("cfw_"+d+"_loaded",[b])},b.dealFilterUF=function(a,b){var c={},d=a.attr("data-list-filter")?a.attr("data-list-filter").split(","):[];return d.length&&$.each(d,function(a,d){var d=d.toUpperCase(),e="!"===d.substr(0,1);e||(c[d]={},c[d]=b[d]),e&&(d=d.slice(1),Object.keys(c).length||(c=b),delete c[d])}),d.length||(c=b),c},b.generateOptions=function(a,b,c){var d="",e=this,c="states"==a?e.dealFilterUF(b,c):c,f=b.attr("data-list-start")?b.attr("data-list-start").toLowerCase():null;return $.each(c,function(c,e){var g=e,h="";"states"==a&&("true"==b.attr("data-list-initials")&&(g=c),h+=' data-uf="'+c+'"'),f!=e.toLowerCase()&&f!=c.toString().toLowerCase()||(h+=" selected"),d+="<option "+h.toLowerCase()+' value="'+g+'">'+g+"</option>"}),d},b.disableCities=function(a){a.attr({disabled:!0,"data-list-loaded":!0}).html('<option value="0" selected>Selecione uma cidade</option>'),$(document).trigger("cfw_cidades_loaded",[a])},"undefined"!=typeof exports?exports.citystate=b:a.citystate=b}("undefined"!=typeof global?global:this);